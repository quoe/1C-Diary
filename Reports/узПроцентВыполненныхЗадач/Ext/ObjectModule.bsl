
Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	
	ТекстОшибки = "";
	
	ПроверитьДанныеЗадач(ТекстОшибки);
	
	Если ЗначениеЗаполнено(ТекстОшибки) Тогда 
		Отказ = Истина;
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = ТекстОшибки;
		Сообщение.УстановитьДанные(ЭтотОбъект);
		Сообщение.Сообщить();
	КонецЕсли;
	
КонецПроцедуры

Процедура ПроверитьДанныеЗадач(ТекстОшибки)
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	КОЛИЧЕСТВО(узЗадачи.Ссылка) КАК КоличествоНеверныхДокументов
	|ИЗ
	|	Справочник.узЗадачи КАК узЗадачи
	|ГДЕ
	|	узЗадачи.ДатаСоздания <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|	И ВЫБОР
	|			КОГДА узЗадачи.Статус.ВидСтатуса = ЗНАЧЕНИЕ(справочник.узВидыСтатусов.Готово)
	|				ТОГДА узЗадачи.ДатаВыполнения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|		КОНЕЦ";
	
	ВыборкаОшибочныхДокументов = Запрос.Выполнить().Выбрать();
	ВыборкаОшибочныхДокументов.Следующий();
	
	Если ВыборкаОшибочныхДокументов.КоличествоНеверныхДокументов = 0 Тогда
		ТекстОшибки = ТекстОшибки + "У некоторых задач не установлены дата создания, а в выполненых - дата выполнения! Отчет будет сформирован неверно!";
	КонецЕсли;	
	
КонецПроцедуры

